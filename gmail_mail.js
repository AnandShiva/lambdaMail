const fs = require('fs');
const readline = require('readline');
const {google} = require('googleapis');

// If modifying these scopes, delete token.json.
//const SCOPES = ['https://www.googleapis.com/auth/gmail.readonly'];
const SCOPES = ['https://mail.google.com','https://www.googleapis.com/auth/gmail.modify','https://www.googleapis.com/auth/gmail.compose','https://www.googleapis.com/auth/gmail.send'];

// The file token.json stores the user's access and refresh tokens, and is
// created automatically when the authorization flow completes for the first
// time.
const TOKEN_PATH = 'token.json';

// Load client secrets from a local file.
fs.readFile('credentials.json', (err, content) => {
  if (err) return console.log('Error loading client secret file:', err);
  // Authorize a client with credentials, then call the Gmail API.
  //authorize(JSON.parse(content), listLabels);
  authorize(JSON.parse(content), sendMail);
});

/**
 * Create an OAuth2 client with the given credentials, and then execute the
 * given callback function.
 * @param {Object} credentials The authorization client credentials.
 * @param {function} callback The callback to call with the authorized client.
 */
function authorize(credentials, callback) {
  const {client_secret, client_id, redirect_uris} = credentials.installed;
  const oAuth2Client = new google.auth.OAuth2(
      client_id, client_secret, redirect_uris[0]);

  // Check if we have previously stored a token.
  fs.readFile(TOKEN_PATH, (err, token) => {
    if (err) return getNewToken(oAuth2Client, callback);
    oAuth2Client.setCredentials(JSON.parse(token));
    callback(oAuth2Client);
  });
}

/**
 * Get and store new token after prompting for user authorization, and then
 * execute the given callback with the authorized OAuth2 client.
 * @param {google.auth.OAuth2} oAuth2Client The OAuth2 client to get token for.
 * @param {getEventsCallback} callback The callback for the authorized client.
 */
function getNewToken(oAuth2Client, callback) {
  const authUrl = oAuth2Client.generateAuthUrl({
    access_type: 'offline',
    scope: SCOPES,
  });
  console.log('Authorize this app by visiting this url:', authUrl);
  const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
  });
  rl.question('Enter the code from that page here: ', (code) => {
    rl.close();
    oAuth2Client.getToken(code, (err, token) => {
      if (err) return console.error('Error retrieving access token', err);
      oAuth2Client.setCredentials(token);
      // Store the token to disk for later program executions
      fs.writeFile(TOKEN_PATH, JSON.stringify(token), (err) => {
        if (err) return console.error(err);
        console.log('Token stored to', TOKEN_PATH);
      });
      callback(oAuth2Client);
    });
  });
}

/**
 * Lists the labels in the user's account.
 *
 * @param {google.auth.OAuth2} auth An authorized OAuth2 client.
 */
function listLabels(auth) {
  const gmail = google.gmail({version: 'v1', auth});
  gmail.users.labels.list({
    userId: 'anandshivaunofficial@gmail.com',
  }, (err, res) => {
    if (err) return console.log('The API returned an error: ' + err);
    const labels = res.data.labels;
    if (labels.length) {
      console.log('Labels:');
      labels.forEach((label) => {
        console.log(`- ${label.name}`);
      });
    } else {
      console.log('No labels found.');
    }
  });
}

function sendMail(auth){
    const gmail = google.gmail({version: 'v1', auth});
    let base64EncodedEmail = "RGVsaXZlcmVkLVRvOiBhbmFuZHNoaXZhdW5vZmZpY2lhbEBnbWFpbC5jb20NClJlY2VpdmVkOiBieSAyMDAyOmFjODo1NDA5OjA6MDowOjA6MCB3aXRoIFNNVFAgaWQgYjljc3AxMDYyOTYwcXRxOw0KICAgICAgICBGcmksIDE2IEF1ZyAyMDE5IDA5OjQxOjU5IC0wNzAwIChQRFQpDQpYLVJlY2VpdmVkOiBieSAyMDAyOmFiMDozMDhjOjogd2l0aCBTTVRQIGlkIGgxMm1yMzMyMTUydWFsLjc2LjE1NjU5NzM3MTk5MDM7DQogICAgICAgIEZyaSwgMTYgQXVnIDIwMTkgMDk6NDE6NTkgLTA3MDAgKFBEVCkNCkFSQy1TZWFsOiBpPTE7IGE9cnNhLXNoYTI1NjsgdD0xNTY1OTczNzE5OyBjdj1ub25lOw0KICAgICAgICBkPWdvb2dsZS5jb207IHM9YXJjLTIwMTYwODE2Ow0KICAgICAgICBiPXpoS3dBSWpFQ2lndGNtYUgyRHFZRW80bnVuUTlOWm1JcHJkdFRGTWk3d2NIbVJMbnJ4SlVhQnVPejNsY1d1KzRDVw0KICAgICAgICAgUFhEczVOWW1KWUNrMitJeXZRN1JsZkxPSldLTWRtUGFTWXNKYVdPOW5neG02VDVodmh6OGxNZ3pVSkJpb1pKb0Y2cGENCiAgICAgICAgIGgySWZXVml0RVBxY1FlaENZMVExdmtHTDlJMEZrV2pTcDAzQ0xsbG9rMGlrMmJzZ0ZNNzdBNHhrRWw5ZmNSZGk5NlMrDQogICAgICAgICBxZUlaZzFQL2dlNTkwb2cyQ0ZLdEkvcWI5RGV2b3hsczE5YzV1VkVEeVFDYWthdWRVcTJpay95UVhPcTVFRVJNU3F1aw0KICAgICAgICAgTWdndkxlSS85UHFTRWhHYTBSaXNaMnlLTVRwVXhoT3UvcW9EYXkwU0ZPTFBYODFodUpUNnBmNVgwYnorYmFtQlZTOWQNCiAgICAgICAgIERhVVE9PQ0KQVJDLU1lc3NhZ2UtU2lnbmF0dXJlOiBpPTE7IGE9cnNhLXNoYTI1NjsgYz1yZWxheGVkL3JlbGF4ZWQ7IGQ9Z29vZ2xlLmNvbTsgcz1hcmMtMjAxNjA4MTY7DQogICAgICAgIGg9dG86ZnJvbTpzdWJqZWN0Om1lc3NhZ2UtaWQ6ZmVlZGJhY2staWQ6ZGF0ZTptaW1lLXZlcnNpb24NCiAgICAgICAgIDpka2ltLXNpZ25hdHVyZTsNCiAgICAgICAgYmg9TTVIZDlRSXdtckpjVDNiendsRUowQlIwSkJTeThSRExDWWtFRnpwM0dpST07DQogICAgICAgIGI9UWdKYjBBa21xVVhzRWMzVmZwY2dsWjJ6UjluN2tHY24zdkRqWDBmZHd0cFFIMkY4cnoyd1NkNzl2Z2V1bFg4TW5hDQogICAgICAgICBWRFZyMGltdHVsWndJMWVyYUV3M055TEhnVmk0VG9FbEttSzgyOS9uWlp3TmlpZ0cyUGwrUkx1akN2WGZVV0wrTDlWMQ0KICAgICAgICAgU0Zhc1dSTjU1cWYxQVdsQVFraTFHTnpoOUtyWVhqOTAvendrd2sxbFgzbjB6SFQ2Y3pLb01QRDdRQ09weFV4dEFmWXUNCiAgICAgICAgIFV1QzRZaTFoM0QwLzl4cUk0NzA3WDBkVFRqdnFPYWJQT1hQQnlPNTQvbDhOb3h5QVE2d05yVEJvRXp1NFNPeVJBUUNEDQogICAgICAgICBmRTNHdGthak5aNXFzUGtaZmF6RWlMM051a0owcTF4UExvbUFDZkQzVzdsTFBoOHFjaG85UTN5VnZRQXNzT1ZZYUtqTw0KICAgICAgICAgbUd0UT09DQpBUkMtQXV0aGVudGljYXRpb24tUmVzdWx0czogaT0xOyBteC5nb29nbGUuY29tOw0KICAgICAgIGRraW09cGFzcyBoZWFkZXIuaT1AYWNjb3VudHMuZ29vZ2xlLmNvbSBoZWFkZXIucz0yMDE2MTAyNSBoZWFkZXIuYj1LNjBCYmJZRDsNCiAgICAgICBzcGY9cGFzcyAoZ29vZ2xlLmNvbTogZG9tYWluIG9mIDMxOXh3eHFndGFud2xtLXBjbmp3OGFhbXNscnEuZW1tZWpjLmFta0BnYWlhLmJvdW5jZXMuZ29vZ2xlLmNvbSBkZXNpZ25hdGVzIDIwOS44NS4yMjAuNzMgYXMgcGVybWl0dGVkIHNlbmRlcikgc210cC5tYWlsZnJvbT0zMTl4V1hRZ1RBTndMTS1QQ05KVzhBQU1TTFJRLkVNTUVKQy5BTUtAZ2FpYS5ib3VuY2VzLmdvb2dsZS5jb207DQogICAgICAgZG1hcmM9cGFzcyAocD1SRUpFQ1Qgc3A9UkVKRUNUIGRpcz1OT05FKSBoZWFkZXIuZnJvbT1hY2NvdW50cy5nb29nbGUuY29tDQpSZXR1cm4tUGF0aDogPDMxOXhXWFFnVEFOd0xNLVBDTkpXOEFBTVNMUlEuRU1NRUpDLkFNS0BnYWlhLmJvdW5jZXMuZ29vZ2xlLmNvbT4NClJlY2VpdmVkOiBmcm9tIG1haWwtc29yLWY3My5nb29nbGUuY29tIChtYWlsLXNvci1mNzMuZ29vZ2xlLmNvbS4gWzIwOS44NS4yMjAuNzNdKQ0KICAgICAgICBieSBteC5nb29nbGUuY29tIHdpdGggU01UUFMgaWQgdDlzb3IzNTE1ODU4dnNsLjM3LjIwMTkuMDguMTYuMDkuNDEuNTkNCiAgICAgICAgZm9yIDxhbmFuZHNoaXZhdW5vZmZpY2lhbEBnbWFpbC5jb20-DQogICAgICAgIChHb29nbGUgVHJhbnNwb3J0IFNlY3VyaXR5KTsNCiAgICAgICAgRnJpLCAxNiBBdWcgMjAxOSAwOTo0MTo1OSAtMDcwMCAoUERUKQ0KUmVjZWl2ZWQtU1BGOiBwYXNzIChnb29nbGUuY29tOiBkb21haW4gb2YgMzE5eHd4cWd0YW53bG0tcGNuanc4YWFtc2xycS5lbW1lamMuYW1rQGdhaWEuYm91bmNlcy5nb29nbGUuY29tIGRlc2lnbmF0ZXMgMjA5Ljg1LjIyMC43MyBhcyBwZXJtaXR0ZWQgc2VuZGVyKSBjbGllbnQtaXA9MjA5Ljg1LjIyMC43MzsNCkF1dGhlbnRpY2F0aW9uLVJlc3VsdHM6IG14Lmdvb2dsZS5jb207DQogICAgICAgZGtpbT1wYXNzIGhlYWRlci5pPUBhY2NvdW50cy5nb29nbGUuY29tIGhlYWRlci5zPTIwMTYxMDI1IGhlYWRlci5iPUs2MEJiYllEOw0KICAgICAgIHNwZj1wYXNzIChnb29nbGUuY29tOiBkb21haW4gb2YgMzE5eHd4cWd0YW53bG0tcGNuanc4YWFtc2xycS5lbW1lamMuYW1rQGdhaWEuYm91bmNlcy5nb29nbGUuY29tIGRlc2lnbmF0ZXMgMjA5Ljg1LjIyMC43MyBhcyBwZXJtaXR0ZWQgc2VuZGVyKSBzbXRwLm1haWxmcm9tPTMxOXhXWFFnVEFOd0xNLVBDTkpXOEFBTVNMUlEuRU1NRUpDLkFNS0BnYWlhLmJvdW5jZXMuZ29vZ2xlLmNvbTsNCiAgICAgICBkbWFyYz1wYXNzIChwPVJFSkVDVCBzcD1SRUpFQ1QgZGlzPU5PTkUpIGhlYWRlci5mcm9tPWFjY291bnRzLmdvb2dsZS5jb20NCkRLSU0tU2lnbmF0dXJlOiB2PTE7IGE9cnNhLXNoYTI1NjsgYz1yZWxheGVkL3JlbGF4ZWQ7DQogICAgICAgIGQ9YWNjb3VudHMuZ29vZ2xlLmNvbTsgcz0yMDE2MTAyNTsNCiAgICAgICAgaD1taW1lLXZlcnNpb246ZGF0ZTpmZWVkYmFjay1pZDptZXNzYWdlLWlkOnN1YmplY3Q6ZnJvbTp0bzsNCiAgICAgICAgYmg9TTVIZDlRSXdtckpjVDNiendsRUowQlIwSkJTeThSRExDWWtFRnpwM0dpST07DQogICAgICAgIGI9SzYwQmJiWURaVVRRTi9yWWxwQmpZb3VacVNDOWFlSzBqblFycnFQemVBSkY0ekFkTlJJZ0s2OTNQbUxMUTNGcSt4DQogICAgICAgICBpZHhlcmZvSloxRk5ZajhlQ016VDgwVXFOWkxnano1akpjeXRnWTFuSWw3TXFLNkhKZjZJbHVsYm95a1pqVWlQR2huWA0KICAgICAgICAgWW84L1llQmFtTzA0OWppTUVuVkhGLytWbXhwOEprZy80TytIUmxZekFVRGJIVjlHaHFPNmhFelpadWkzTnhhbVhWcUINCiAgICAgICAgIFNyQmJ4SEV2cFRMRENZckZ5NDU0cHFwM09ZR3c4TEdhOUp1OTZqejNTMlZFeWhSZEZUUjg4MlRtdWJ1bFlKR1hFWFg2DQogICAgICAgICBnMjVHUkhYWWVUeDBIbTkrMWFyOTB3NVFhelNoNTEyeUczRDZNYXZMNXp5ZE5zN1FNSzZlK1dIU2pzczVhWEZvcXErWA0KICAgICAgICAgem5HUT09DQpYLUdvb2dsZS1ES0lNLVNpZ25hdHVyZTogdj0xOyBhPXJzYS1zaGEyNTY7IGM9cmVsYXhlZC9yZWxheGVkOw0KICAgICAgICBkPTFlMTAwLm5ldDsgcz0yMDE2MTAyNTsNCiAgICAgICAgaD14LWdtLW1lc3NhZ2Utc3RhdGU6bWltZS12ZXJzaW9uOmRhdGU6ZmVlZGJhY2staWQ6bWVzc2FnZS1pZDpzdWJqZWN0DQogICAgICAgICA6ZnJvbTp0bzsNCiAgICAgICAgYmg9TTVIZDlRSXdtckpjVDNiendsRUowQlIwSkJTeThSRExDWWtFRnpwM0dpST07DQogICAgICAgIGI9cVVIbWlCcGZDQ29oTUhOT1R2andQbzJIZGhSYWFEQkc2VUZSRDlScEwvSnlJUnVNbDZSblpDd2UyZTdlaTd6QTZYDQogICAgICAgICA2OXFVdlFnamoxYjBDS2ozUXFYaGdwQXZ1NE1TOWNBVjdVenpqdjIvTkFkTkJXMk5vMXlDOEtzUzM4UVlRMitrbXBxVg0KICAgICAgICAgN016NlgzOXpBRUQ5Y2dBNHBSMFlPSyt1TTBmZEZkdWowKzJhYi9kOWQvUUJBdmN3dUlmMkpidHBQUGVmUjVCeEIyeEENCiAgICAgICAgIHc2MHJsdHFFU3hQOGFEVkxJZ0U4M29CaFUzc01sMklyWUE3STVQWGkwWmlzdWliOEJiK2t4bTdaM2d3a1NKQ2lFNmp0DQogICAgICAgICBvaStQUVIzdXRidjhYQ2Q1VVZOVDRDdXB5VER1cU1aTGFmeDdKOFVBN3VHN1FiZktKaGc3c2tJL3pzaW52MVNOMjgzZQ0KICAgICAgICAgYlB5dz09DQpYLUdtLU1lc3NhZ2UtU3RhdGU6IEFQakFBQVYxOVdJY3RCYjhvZ1JXQUcybUN1bGRRUTFHVUtaVjlVQmxHMFI2M1Y2d01BbWxnTmdpDQoJY045TUFQTzhaYVF1MnhmK0puUklwUFNGQUZIekZGR0YNClgtR29vZ2xlLVNtdHAtU291cmNlOiBBUFh2WXF5YVNFeUE0OEJ3eVJEa0JPNGlTZWVhS05iSG83OWZTVFZodHYxRXMwRkhOQndqZUFzbzZ4OXJ5R3VuREd3RDVzVXV5dUdDdWhOVnFyRmttSHhDRHdNMWhBPT0NCk1JTUUtVmVyc2lvbjogMS4wDQpYLVJlY2VpdmVkOiBieSAyMDAyOmE2NzpmZDEzOjogd2l0aCBTTVRQIGlkIGYxOW1yNjc0NzY4NHZzci41My4xNTY1OTczNzE5NDM2Ow0KIEZyaSwgMTYgQXVnIDIwMTkgMDk6NDE6NTkgLTA3MDAgKFBEVCkNCkRhdGU6IEZyaSwgMTYgQXVnIDIwMTkgMTY6NDE6NTggKzAwMDAgKEdNVCkNClgtQWNjb3VudC1Ob3RpZmljYXRpb24tVHlwZTogMTI3LWFuZXhwI2dpdmFiLWZhLS1tZHYyLWZhDQpGZWVkYmFjay1JRDogMTI3LWFuZXhwI2dpdmFiLWZhLS1tZHYyLWZhOmFjY291bnQtbm90aWZpZXINClgtTm90aWZpY2F0aW9uczogNjZmNmJmNzVkODgwMDAwMA0KTWVzc2FnZS1JRDogPFJ3WFRrOFJ1c1RVOFBRaVBmaDd3RlEuMEBub3RpZmljYXRpb25zLmdvb2dsZS5jb20-DQpTdWJqZWN0OiBTZWN1cml0eSBhbGVydA0KRnJvbTogR29vZ2xlIDxuby1yZXBseUBhY2NvdW50cy5nb29nbGUuY29tPg0KVG86IGFuYW5kc2hpdmF1bm9mZmljaWFsQGdtYWlsLmNvbQ0KQ29udGVudC1UeXBlOiBtdWx0aXBhcnQvYWx0ZXJuYXRpdmU7IGJvdW5kYXJ5PSIwMDAwMDAwMDAwMDA0NjUzNGYwNTkwM2VhYmQ0Ig0KDQotLTAwMDAwMDAwMDAwMDQ2NTM0ZjA1OTAzZWFiZDQNCkNvbnRlbnQtVHlwZTogdGV4dC9wbGFpbjsgY2hhcnNldD0iVVRGLTgiOyBmb3JtYXQ9Zmxvd2VkOyBkZWxzcD15ZXMNCkNvbnRlbnQtVHJhbnNmZXItRW5jb2Rpbmc6IGJhc2U2NA0KDQpSMjl2WjJ4bElFRlFTWE1nUlhod2JHOXlaWElnZDJGeklHZHlZVzUwWldRZ1lXTmpaWE56SUhSdklIbHZkWElnUjI5dloyeGxJRUZqDQpZMjkxYm5RTkNnMEtEUXBoYm1GdVpITm9hWFpoZFc1dlptWnBZMmxoYkVCbmJXRnBiQzVqYjIwTkNnMEtTV1lnZVc5MUlHUnBaQ0J1DQpiM1FnWjNKaGJuUWdZV05qWlhOekxDQjViM1VnYzJodmRXeGtJR05vWldOcklIUm9hWE1nWVdOMGFYWnBkSGtnWVc1a0lITmxZM1Z5DQpaU0I1YjNWeURRcGhZMk52ZFc1MExnMEtRMmhsWTJzZ1lXTjBhWFpwZEhrTkNqeG9kSFJ3Y3pvdkwyRmpZMjkxYm5SekxtZHZiMmRzDQpaUzVqYjIwdlFXTmpiM1Z1ZEVOb2IyOXpaWEkvUlcxaGFXdzlZVzVoYm1SemFHbDJZWFZ1YjJabWFXTnBZV3hBWjIxaGFXd3VZMjl0DQpKbU52Ym5ScGJuVmxQV2gwZEhCek9pOHZiWGxoWTJOdmRXNTBMbWR2YjJkc1pTNWpiMjB2WVd4bGNuUXZiblF2TVRVMk5UazNNemN4DQpPREF3TUQ5eVptNGxNMFF4TWpjbE1qWnlabTVqSlRORU1TVXlObVZwWkNVelJDMDJNamN6TXpjeE1ETTBPVEExTURBNE1qUTVKVEkyDQpaWFFsTTBRd0pUSTJZVzVsZUhBbE0wUm5hWFpoWWkxbVlTMHRiV1IyTWkxbVlUNE5DbGx2ZFNCeVpXTmxhWFpsWkNCMGFHbHpJR1Z0DQpZV2xzSUhSdklHeGxkQ0I1YjNVZ2EyNXZkeUJoWW05MWRDQnBiWEJ2Y25SaGJuUWdZMmhoYm1kbGN5QjBieUI1YjNWeURRcEhiMjluDQpiR1VnUVdOamIzVnVkQ0JoYm1RZ2MyVnlkbWxqWlhNdURRckNxU0F5TURFNUlFZHZiMmRzWlNCTVRFTXNJREUyTURBZ1FXMXdhR2wwDQphR1ZoZEhKbElGQmhjbXQzWVhrc0lFMXZkVzUwWVdsdUlGWnBaWGNzSUVOQklEazBNRFF6TENCVlUwRU5DZz09DQotLTAwMDAwMDAwMDAwMDQ2NTM0ZjA1OTAzZWFiZDQNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PSJVVEYtOCINCkNvbnRlbnQtVHJhbnNmZXItRW5jb2Rpbmc6IHF1b3RlZC1wcmludGFibGUNCg0KPCFET0NUWVBFIGh0bWw-PGh0bWwgbGFuZz0zRGVuPjxoZWFkPjxtZXRhIG5hbWU9M0Rmb3JtYXQtZGV0ZWN0aW9uIGNvbnRlbnQ9DQo9M0RlbWFpbD0zRG5vIC8-PG1ldGEgbmFtZT0zRGZvcm1hdC1kZXRlY3Rpb24gY29udGVudD0zRGRhdGU9M0RubyAvPjxzdHlsZSA9DQpub25jZT0zRDd4WGFMa2ZNYW1TUmtxRjFTWEdheXc-LmF3bCBhIHtjb2xvcjogI0ZGRkZGRjsgdGV4dC1kZWNvcmF0aW9uOiBub249DQplO30gLmFibWwgYSB7Y29sb3I6ICMwMDAwMDA7IGZvbnQtZmFtaWx5OiBSb2JvdG8tTWVkaXVtLEhlbHZldGljYSxBcmlhbCxzYW49DQpzLXNlcmlmOyBmb250LXdlaWdodDogYm9sZDsgdGV4dC1kZWNvcmF0aW9uOiBub25lO30gLmFkZ2wgYSB7Y29sb3I6IHJnYmEoMCw9DQogMCwgMCwgMC44Nyk7IHRleHQtZGVjb3JhdGlvbjogbm9uZTt9IC5hZmFsIGEge2NvbG9yOiAjYjBiMGIwOyB0ZXh0LWRlY29yYXQ9DQppb246IG5vbmU7fSBAbWVkaWEgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA2MDBweCkgey52MnNwIHtwYWRkaW5nOiA2cHggMzBweCA9DQowcHg7fSAudjJyc3Age3BhZGRpbmc6IDBweCAxMHB4O319IEBtZWRpYSBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDYwMHB4KSB7Lm09DQpkdjJydyB7cGFkZGluZzogNDBweCA0MHB4O319IDwvc3R5bGU-PGxpbmsgaHJlZj0zRC8vZm9udHMuZ29vZ2xlYXBpcy5jb20vY3M9DQpzP2ZhbWlseT0zREdvb2dsZStTYW5zIHJlbD0zRHN0eWxlc2hlZXQgdHlwZT0zRHRleHQvY3NzIC8-PC9oZWFkPjxib2R5IHN0eWw9DQplPTNEIm1hcmdpbjogMDsgcGFkZGluZzogMDsiIGJnY29sb3I9M0QjRkZGRkZGPjxpbWcgc3JjPTNEaHR0cHM6Ly9ub3RpZmljYXQ9DQppb25zLmdvb2dsZWFwaXMuY29tL2VtYWlsL3QvQUZHOHF5WGE2a0RMQ2c0c3RLUzJ0c1Nidm1ZLUd1aHFEUE52dW9QWXk4blNDQ189DQpDejZHdUdLUlpKUUxJN1NlRkotemRobHlGY1VSTlh0ZTkzdGk3TGJQdmczOXMtaWlwdGVsVXJnY0ZXZW44NkR6VTFva2Mzc0puTXc9DQpKalN2dHNBN3pWRFN2LTE4STVIZXBsZmIzcjJ5YVNTY0tGZDRaemNLT1FhU0RCZ25iMzZLc2dSV1RuM2FEcjZ5N2x3Yi1mTG9hRjU9DQpNbXdXYWNsQjJtNHAzYTdaS0hLVm1lVDdabGs4ZjdrTjdfRzYtOXpzRE5KdmpkT0R0aGQ5UU1QdGNlUEQxQVFFUF9VMG1PSmRMVkM9DQpabjVfZVNNOGZXQS9hLmdpZiB3aWR0aD0zRDEgaGVpZ2h0PTNEMT48dGFibGUgd2lkdGg9M0QxMDAlIGhlaWdodD0zRDEwMCUgc3Q9DQp5bGU9M0QibWluLXdpZHRoOiAzNDhweDsiIGJvcmRlcj0zRDAgY2VsbHNwYWNpbmc9M0QwIGNlbGxwYWRkaW5nPTNEMCBsYW5nPQ0KPTNEZW4-PHRyIGhlaWdodD0zRDMyIHN0eWxlPTNEImhlaWdodDogMzJweDsiPjx0ZD48L3RkPjwvdHI-PHRyIGFsaWduPTNEY2VuPQ0KdGVyPjx0ZD48ZGl2IGl0ZW1zY29wZSBpdGVtdHlwZT0zRC8vc2NoZW1hLm9yZy9FbWFpbE1lc3NhZ2U-PGRpdiBpdGVtcHJvcD0NCj0zRGFjdGlvbiBpdGVtc2NvcGUgaXRlbXR5cGU9M0QvL3NjaGVtYS5vcmcvVmlld0FjdGlvbj48bGluayBpdGVtcHJvcD0zRHVybD0NCiBocmVmPTNEaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL0FjY291bnRDaG9vc2VyP0VtYWlsPTNEYW5hbmRzaGl2YXVub2ZmaT0NCmNpYWxAZ21haWwuY29tJmFtcDtjb250aW51ZT0zRGh0dHBzOi8vbXlhY2NvdW50Lmdvb2dsZS5jb20vYWxlcnQvbnQvMTU2NTk3Mz0NCjcxODAwMD9yZm4lM0QxMjclMjZyZm5jJTNEMSUyNmVpZCUzRC02MjczMzcxMDM0OTA1MDA4MjQ5JTI2ZXQlM0QwJTI2YW5leHAlMz0NCkRnaXZhYi1mYS0tbWR2Mi1mYSAvPjxtZXRhIGl0ZW1wcm9wPTNEbmFtZSBjb250ZW50PTNEIlJldmlldyBBY3Rpdml0eSIgLz48Lz0NCmRpdj48L2Rpdj48dGFibGUgYm9yZGVyPTNEMCBjZWxsc3BhY2luZz0zRDAgY2VsbHBhZGRpbmc9M0QwIHN0eWxlPTNEInBhZGRpbj0NCmctYm90dG9tOiAyMHB4O21heC13aWR0aDogNTE2cHg7bWluLXdpZHRoOiAyMjBweDsiPjx0cj48dGQgd2lkdGg9M0Q4IHN0eWxlPQ0KPTNEIndpZHRoOiA4cHg7Ij48L3RkPjx0ZD48ZGl2IHN0eWxlPTNEImJvcmRlci1zdHlsZTogc29saWQ7IGJvcmRlci13aWR0aDogPQ0KdGhpbjsgYm9yZGVyLWNvbG9yOiNkYWRjZTA7IGJvcmRlci1yYWRpdXM6IDhweDsgcGFkZGluZzogNDBweCAyMHB4OyIgYWxpZ249DQo9M0RjZW50ZXIgY2xhc3M9M0RtZHYycnc-PGltZyB3aWR0aD0zRDc1IGhlaWdodD0zRDI0IHNyYz0zRGh0dHBzOi8vd3d3LmdzdGE9DQp0aWMuY29tL2FjY291bnRhbGVydHMvZW1haWwvZ29vZ2xlbG9nb19jb2xvcl8xODh4NjRkcC5wbmcgc3R5bGU9M0Qid2lkdGg6IDc9DQo1cHg7IGhlaWdodDogMjRweDsgbWFyZ2luLWJvdHRvbTogMTZweDsiPjxkaXYgc3R5bGU9M0QiZm9udC1mYW1pbHk6ICYjMzk7R289DQpvZ2xlIFNhbnMmIzM5OyxSb2JvdG8sUm9ib3RvRHJhZnQsSGVsdmV0aWNhLEFyaWFsLHNhbnMtc2VyaWY7Ym9yZGVyLWJvdHRvbTo9DQogdGhpbiBzb2xpZCAjZGFkY2UwOyBjb2xvcjogcmdiYSgwLDAsMCwwLjg3KTsgbGluZS1oZWlnaHQ6IDMycHg7IHBhZGRpbmctYm89DQp0dG9tOiAyNHB4O3RleHQtYWxpZ246IGNlbnRlcjsgd29yZC1icmVhazogYnJlYWstd29yZDsiPjxkaXYgc3R5bGU9M0QiZm9udC09DQpzaXplOiAyNHB4OyI-PGE-R29vZ2xlIEFQSXMgRXhwbG9yZXI8L2E-IHdhcyBncmFudGVkIGFjY2VzcyB0byB5b3VyIEdvb2dsZSY9DQpuYnNwO0FjY291bnQ8L2Rpdj48dGFibGUgYWxpZ249M0RjZW50ZXIgc3R5bGU9M0RtYXJnaW4tdG9wOjhweDs-PHRyIHN0eWxlPQ0KPTNEImxpbmUtaGVpZ2h0OiBub3JtYWw7Ij48dGQgYWxpZ249M0RyaWdodCBzdHlsZT0zRHBhZGRpbmctcmlnaHQ6OHB4Oz48aW1nPQ0KIHdpZHRoPTNEMjAgaGVpZ2h0PTNEMjAgc3R5bGU9M0Qid2lkdGg6IDIwcHg7IGhlaWdodDogMjBweDsgdmVydGljYWwtYWxpZ246PQ0KIHN1YjsgYm9yZGVyLXJhZGl1czogNTAlOzsiIHNyYz0zRGh0dHBzOi8vd3d3LmdzdGF0aWMuY29tL2FjY291bnRhbGVydHMvZW1hPQ0KaWwvYW5vbnltb3VzX3Byb2ZpbGVfcGhvdG8ucG5nPjwvdGQ-PHRkPjxhIHN0eWxlPTNEImZvbnQtZmFtaWx5OiAmIzM5O0dvb2dsPQ0KZSBTYW5zJiMzOTssUm9ib3RvLFJvYm90b0RyYWZ0LEhlbHZldGljYSxBcmlhbCxzYW5zLXNlcmlmO2NvbG9yOiByZ2JhKDAsMCwwPQ0KLDAuODcpOyBmb250LXNpemU6IDE0cHg7IGxpbmUtaGVpZ2h0OiAyMHB4OyI-YW5hbmRzaGl2YXVub2ZmaWNpYWxAZ21haWwuY29tPQ0KPC9hPjwvdGQ-PC90cj48L3RhYmxlPjwvZGl2PjxkaXYgc3R5bGU9M0QiZm9udC1mYW1pbHk6IFJvYm90by1SZWd1bGFyLEhlbHZlPQ0KdGljYSxBcmlhbCxzYW5zLXNlcmlmOyBmb250LXNpemU6IDE0cHg7IGNvbG9yOiByZ2JhKDAsMCwwLDAuODcpOyBsaW5lLWhlaWdoPQ0KdDogMjBweDtwYWRkaW5nLXRvcDogMjBweDsgdGV4dC1hbGlnbjogbGVmdDsiPjxicj5JZiB5b3UgZGlkIG5vdCBncmFudCBhY2NlPQ0Kc3MsIHlvdSBzaG91bGQgY2hlY2sgdGhpcyBhY3Rpdml0eSBhbmQgc2VjdXJlIHlvdXIgYWNjb3VudC48ZGl2IHN0eWxlPTNEInBhPQ0KZGRpbmctdG9wOiAzMnB4O3RleHQtYWxpZ246IGNlbnRlcjsiPjxhIGhyZWY9M0RodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vPQ0KQWNjb3VudENob29zZXI_RW1haWw9M0RhbmFuZHNoaXZhdW5vZmZpY2lhbEBnbWFpbC5jb20mYW1wO2NvbnRpbnVlPTNEaHR0cHM6PQ0KLy9teWFjY291bnQuZ29vZ2xlLmNvbS9hbGVydC9udC8xNTY1OTczNzE4MDAwP3JmbiUzRDEyNyUyNnJmbmMlM0QxJTI2ZWlkJTNEPQ0KLTYyNzMzNzEwMzQ5MDUwMDgyNDklMjZldCUzRDAlMjZhbmV4cCUzRGdpdmFiLWZhLS1tZHYyLWZhIHRhcmdldD0zRF9ibGFuayBzPQ0KdHlsZT0zRCJmb250LWZhbWlseTogJiMzOTtHb29nbGUgU2FucyYjMzk7LFJvYm90byxSb2JvdG9EcmFmdCxIZWx2ZXRpY2EsQXJpPQ0KYWwsc2Fucy1zZXJpZjsgbGluZS1oZWlnaHQ6IDE2cHg7IGNvbG9yOiAjZmZmZmZmOyBmb250LXdlaWdodDogNDAwOyB0ZXh0LWRlPQ0KY29yYXRpb246IG5vbmU7Zm9udC1zaXplOiAxNHB4O2Rpc3BsYXk6aW5saW5lLWJsb2NrO3BhZGRpbmc6IDEwcHggMjRweDtiYWNrPQ0KZ3JvdW5kLWNvbG9yOiAjNDE4NEYzOyBib3JkZXItcmFkaXVzOiA1cHg7IG1pbi13aWR0aDogOTBweDsiPkNoZWNrIGFjdGl2aXR5PQ0KPC9hPjwvZGl2PjwvZGl2PjwvZGl2PjxkaXYgc3R5bGU9M0QidGV4dC1hbGlnbjogbGVmdDsiPjxkaXYgc3R5bGU9M0QiZm9udC1mPQ0KYW1pbHk6IFJvYm90by1SZWd1bGFyLEhlbHZldGljYSxBcmlhbCxzYW5zLXNlcmlmO2NvbG9yOiByZ2JhKDAsMCwwLDAuNTQpO2ZvPQ0KbnQtc2l6ZTogMTFweDsgbGluZS1oZWlnaHQ6IDE4cHg7IHBhZGRpbmctdG9wOiAxMnB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48PQ0KZGl2PllvdSByZWNlaXZlZCB0aGlzIGVtYWlsIHRvIGxldCB5b3Uga25vdyBhYm91dCBpbXBvcnRhbnQgY2hhbmdlcyB0byB5b3VyPQ0KIEdvb2dsZSBBY2NvdW50IGFuZCBzZXJ2aWNlcy48L2Rpdj48ZGl2IHN0eWxlPTNEImRpcmVjdGlvbjogbHRyOyI-JmNvcHk7IDIwPQ0KMTkgR29vZ2xlIExMQywgPGEgY2xhc3M9M0RhZmFsIHN0eWxlPTNEImZvbnQtZmFtaWx5OiBSb2JvdG8tUmVndWxhcixIZWx2ZXRpPQ0KY2EsQXJpYWwsc2Fucy1zZXJpZjtjb2xvcjogcmdiYSgwLDAsMCwwLjU0KTtmb250LXNpemU6IDExcHg7IGxpbmUtaGVpZ2h0OiAxPQ0KOHB4OyBwYWRkaW5nLXRvcDogMTJweDsgdGV4dC1hbGlnbjogY2VudGVyOyI-MTYwMCBBbXBoaXRoZWF0cmUgUGFya3dheSwgTW91PQ0KbnRhaW4gVmlldywgQ0EgOTQwNDMsIFVTQTwvYT48L2Rpdj48L2Rpdj48L2Rpdj48L3RkPjx0ZCB3aWR0aD0zRDggc3R5bGU9M0QiPQ0Kd2lkdGg6IDhweDsiPjwvdGQ-PC90cj48L3RhYmxlPjwvdGQ-PC90cj48dHIgaGVpZ2h0PTNEMzIgc3R5bGU9M0QiaGVpZ2h0OiAzPQ0KMnB4OyI-PHRkPjwvdGQ-PC90cj48L3RhYmxlPjwvYm9keT48L2h0bWw-DQotLTAwMDAwMDAwMDAwMDQ2NTM0ZjA1OTAzZWFiZDQtLQ0K";
    gmail.users.messages.send({
        'userId': 'anandshivaunofficial@gmail.com',
        'resource': {
          'raw': base64EncodedEmail
        }
      },(err, res) => {
        console.log(err);
        console.log(res);
      });

    // gmail.users.labels.list({
    //   userId: 'me',
    // }, (err, res) => {
    //   if (err) return console.log('The API returned an error: ' + err);
    //   const labels = res.data.labels;
    //   if (labels.length) {
    //     console.log('Labels:');
    //     labels.forEach((label) => {
    //       console.log(`- ${label.name}`);
    //     });
    //   } else {
    //     console.log('No labels found.');
    //   }
    // });
  
}